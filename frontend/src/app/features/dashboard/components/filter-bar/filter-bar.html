<div class="filter-bar">
  <div class="filter-title">
    <svg class="icon-svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
    </svg>
    Filter Dashboard
  </div>

  <div class="controls">
    
    <div class="control-group">
      <label>Machines</label>
      <div class="dropdown-container">
        <div class="dropdown-trigger" (click)="toggleMachineDropdown($event)" [class.active]="isMachineOpen">
          <span *ngIf="selectedMachines.length === 0" class="placeholder">All Machines</span>
          <span *ngIf="selectedMachines.length > 0" class="value-text">{{ selectedMachines.length }} Selected</span>
          
          <svg class="arrow-svg" [class.rotated]="isMachineOpen" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </div>

        <div class="dropdown-menu" [attr.open]="isMachineOpen">
            <label *ngFor="let m of machines" class="checkbox-item">
              <input type="checkbox" 
                [checked]="isSelectedMachine(m)" 
                (change)="toggleMachine(m, $any($event.target).checked)">
              {{ m }}
            </label>
        </div>
        <div *ngIf="isMachineOpen" class="dropdown-backdrop" (click)="isMachineOpen = false"></div>
      </div>
    </div>

    <div class="control-group">
      <label>Scrap Index</label>
      <div class="dropdown-container">
        <div class="dropdown-trigger" (click)="toggleIndexDropdown($event)" [class.active]="isIndexOpen">
          <span *ngIf="selectedIndices.length === 0" class="placeholder">All Indices</span>
          <span *ngIf="selectedIndices.length > 0" class="value-text">{{ selectedIndices.length }} Selected</span>
          
          <svg class="arrow-svg" [class.rotated]="isIndexOpen" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </div>

        <div class="dropdown-menu" [attr.open]="isIndexOpen">
            <label *ngFor="let i of indices" class="checkbox-item">
              <input type="checkbox" 
                [checked]="isSelectedIndex(i)" 
                (change)="toggleIndex(i, $any($event.target).checked)">
              Index {{ i }}
            </label>
        </div>
        <div *ngIf="isIndexOpen" class="dropdown-backdrop" (click)="isIndexOpen = false"></div>
      </div>
    </div>

  </div>
</div>